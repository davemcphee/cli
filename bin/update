#!/usr/bin/env bash

if [ ! -f "longboat.cfg" ]; then
  echo "ERROR! No longboat.cfg found in: ${PROJECTDIR}"
  exit 1
fi

if [ -d "roles" ]; then
  echo "===> Updating Longboat roles..."
  cd roles/
  git stash --quiet
  git pull --quiet
  cd ..
else
  echo "===> Downloading Longboat Roles for the first time..."
  git clone --quiet ${LONGBOAT_ROLES_REPO}
fi

# Gitignore
echo "===> Updating .gitignore file..."
cp ${BOATDIR}/files/gitignore .gitignore
git add .gitignore
git commit --quiet -m "Updating .gitignore"

# Inventories
# FIXME: Deploy inventories
#URL="${LONGBOAT_ENDPOINT}/${LONGBOAT_API}/environment/all"
#curl --compressed -s -H "Authorization: ${LONGBOAT_TOKEN}" -X GET "${URL}"

# Playbooks
# FIXME: Deploy playbook(s)
